<div *ngIf="task && !editMode" class="task-info">
  <h2 class="clearfix">
    {{task.title}}
    <div class="pull-right" *ngIf="task && task.parentTaskId">
      <a *ngIf="root" class="btn btn-sm btn-default"
         [routerLink]="'/app/tasks/' + root._id"
         tooltip="Project: {{root.title | textLimit: 15}}">
        <i class="fa fa-long-arrow-up"></i>&nbsp;{{root.title|textLimit: 10}}
        <span *ngIf="root.title && root.title.length > 10">...</span>
      </a>
    </div>
  </h2>

  <h5 *ngIf="parentTask">
    <a [routerLink]="['/app/tasks/', parentTask._id]"><i class="fa fa-long-arrow-left"></i>
      {{parentTask.title}}</a>
  </h5>

  <app-task-metrics [task]="task" [options]="true" (click)="edit(task)" class="pull-left" ></app-task-metrics>
  <a class="btn btn-sm btn-link pull-right" (click)="toggleTaskHistory()">Details</a>

  <div class="clearfix"></div>

  <task-description-viewer [description]="task.description" [limit]="170"></task-description-viewer>

  <file-viewer *ngIf="task.files.length" [files]="task.files"></file-viewer>

  <task-tags-panel [task]="task" *ngIf="task.tags && task.tags.length"></task-tags-panel>
</div>

<task-history *ngIf="showHistory" [task]="task"></task-history>

<div *ngIf="!showHistory">
  <app-task-edit class="edit-form"></app-task-edit>

  <div>
    <div *ngIf="task && task._id" class="pull-right board-buttons btn-group" role="group">
      <!--<a *ngIf="tasks && tasks.length" class="btn btn-sm btn-default" ui-sref="app.tags-page({taskId: task._id})">Tags</a>-->
      <!--<a class="btn btn-sm btn-default" ui-sref="app.tasks-archive({taskId: task._id})">Archive</a>-->
      <!--<a *ngIf="tasks.length" class="btn btn-sm btn-default"-->
      <!--ui-sref="app.task-report({taskId: task._id, userId: userId})">Report</a>-->
    </div>

    <!--<div *ngIf="tasks && tasks.length" infinite-scroll="scroll()" infinite-scroll-distance="0"-->
    <!--infinite-scroll-disabled="busyScroll">    -->
    <div *ngIf="tasks && tasks.length">
      <!--<div class="pull-right board-buttons" *ngIf="!taskId">-->
        <!--<a class="btn btn-sm btn-default" ui-sref="app.projects-archive">Archive</a>-->
      <!--</div>-->

      <app-tasks-board *ngIf="tasks && tasks.length" [tasks]="tasks"></app-tasks-board>
    </div>

    <div *ngIf="tasks && !tasks.length" class="align-center">
      <h4>No active tasks.</h4>
    </div>
  </div>
</div>

